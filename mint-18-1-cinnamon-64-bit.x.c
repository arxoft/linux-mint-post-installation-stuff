#if 0
	shc Version 3.8.9b, Generic Script Compiler
	Copyright (c) 1994-2015 Francisco Rosales <frosal@fi.upm.es>

	shc -f mint-18-1-cinnamon-64-bit 
#endif

static  char data [] = 
#define      chk1_z	22
#define      chk1	((&data[5]))
	"\272\100\026\235\020\102\165\012\217\260\356\366\154\155\277\060"
	"\041\265\250\103\134\363\230\246\215\162\231\003\371\135\074"
#define      date_z	1
#define      date	((&data[31]))
	"\154"
#define      lsto_z	1
#define      lsto	((&data[32]))
	"\060"
#define      shll_z	10
#define      shll	((&data[35]))
	"\232\365\254\147\125\124\223\116\336\062\042\217"
#define      msg2_z	19
#define      msg2	((&data[48]))
	"\325\235\327\002\373\200\000\227\050\050\207\345\237\277\244\330"
	"\153\022\325\012\320\363\060\115\140"
#define      inlo_z	3
#define      inlo	((&data[70]))
	"\323\013\057"
#define      tst1_z	22
#define      tst1	((&data[73]))
	"\334\167\267\245\252\274\153\014\127\310\330\372\003\242\135\016"
	"\005\230\365\233\375\205\176\025\262\333"
#define      xecc_z	15
#define      xecc	((&data[102]))
	"\315\112\303\022\311\033\303\361\055\031\022\352\112\151\313\270"
	"\336\331\271\164"
#define      rlax_z	1
#define      rlax	((&data[119]))
	"\000"
#define      opts_z	1
#define      opts	((&data[120]))
	"\215"
#define      text_z	2932
#define      text	((&data[413]))
	"\052\226\224\212\303\220\246\061\242\137\257\270\021\213\012\352"
	"\065\330\064\371\222\250\245\206\267\106\027\141\232\175\250\304"
	"\023\075\116\327\315\365\010\160\124\270\051\146\103\064\120\171"
	"\015\205\163\237\056\030\045\346\137\075\107\371\273\360\275\317"
	"\055\014\246\373\002\256\154\126\147\225\275\253\312\016\044\327"
	"\223\227\166\302\260\234\250\017\332\360\011\225\340\306\144\016"
	"\323\012\012\325\271\166\054\041\014\351\314\326\367\361\255\213"
	"\211\044\115\071\300\366\111\233\346\122\060\307\031\224\326\354"
	"\237\340\301\131\126\355\173\143\327\107\071\317\070\347\132\302"
	"\014\250\373\315\236\104\150\204\226\230\113\257\055\042\234\315"
	"\002\135\047\131\113\242\274\043\351\366\362\042\336\115\344\352"
	"\365\340\267\223\044\037\030\273\267\143\153\345\205\007\262\210"
	"\145\331\341\260\174\236\324\146\224\306\210\162\023\155\134\011"
	"\115\023\234\162\063\264\055\352\030\231\320\236\240\202\046\005"
	"\134\010\266\331\246\212\077\073\121\310\255\144\065\012\155\203"
	"\036\012\366\121\276\043\074\327\275\014\165\135\217\234\143\354"
	"\244\031\305\113\244\004\207\365\314\064\132\002\077\310\206\136"
	"\322\174\257\221\240\353\150\135\370\336\272\207\172\036\164\037"
	"\067\071\153\334\254\261\114\354\312\117\351\354\376\131\144\232"
	"\150\213\164\035\333\033\320\151\330\122\101\272\071\367\011\345"
	"\354\334\027\170\257\342\175\353\125\356\171\221\114\301\361\167"
	"\230\161\276\145\353\357\140\062\030\261\307\075\226\152\214\170"
	"\302\363\131\171\370\203\112\122\211\004\026\101\053\226\353\326"
	"\330\311\234\163\240\311\155\072\063\070\064\354\253\137\303\301"
	"\044\260\264\167\365\320\130\127\256\023\077\323\041\343\332\174"
	"\153\240\121\231\156\214\002\040\144\345\120\070\052\027\022\057"
	"\014\215\374\175\100\024\034\353\127\004\167\000\110\016\070\172"
	"\013\107\160\072\075\174\156\042\371\164\315\337\024\320\372\277"
	"\222\266\220\372\014\123\127\332\344\011\140\120\340\226\345\302"
	"\154\165\333\121\205\001\304\064\241\024\165\313\174\272\330\133"
	"\204\056\054\106\151\030\266\027\273\311\137\123\001\035\047\001"
	"\166\003\321\266\033\143\132\363\055\122\057\067\035\262\255\301"
	"\012\364\340\046\055\016\211\204\204\237\074\320\112\246\357\147"
	"\040\000\154\046\346\123\011\364\013\211\371\375\175\243\300\065"
	"\207\360\331\020\343\125\364\127\365\315\047\225\272\137\104\370"
	"\232\032\263\165\074\227\130\046\243\132\346\346\013\003\337\060"
	"\125\040\266\164\072\250\224\145\043\033\216\225\353\026\173\161"
	"\175\036\101\055\203\114\015\140\105\157\170\261\370\335\322\313"
	"\353\152\164\356\060\261\171\214\102\004\157\024\150\275\353\351"
	"\006\051\034\240\274\072\220\151\344\335\000\116\035\356\022\346"
	"\064\133\117\316\302\333\234\371\026\023\272\142\342\147\231\070"
	"\253\154\277\345\257\135\374\243\265\365\143\041\213\376\151\110"
	"\340\342\104\142\361\105\245\045\257\167\117\032\124\122\075\151"
	"\035\001\146\335\236\142\070\121\361\056\377\063\001\270\257\106"
	"\202\007\153\215\344\015\226\327\316\244\113\210\001\342\074\036"
	"\256\257\256\211\272\206\011\160\374\036\121\176\141\162\377\071"
	"\075\226\301\015\112\136\346\142\161\050\300\375\144\373\116\312"
	"\362\220\032\373\351\271\242\145\335\047\053\206\151\073\125\026"
	"\043\142\316\303\374\372\030\100\024\107\074\160\002\333\360\355"
	"\226\013\270\217\126\063\331\305\363\176\076\105\003\033\074\103"
	"\375\343\345\012\063\137\163\354\126\055\142\325\171\343\106\144"
	"\251\326\357\300\173\040\370\137\274\276\343\240\005\315\063\003"
	"\117\071\332\370\372\277\175\116\215\303\374\053\046\031\017\165"
	"\237\205\353\211\005\250\276\066\026\237\274\306\314\110\124\114"
	"\062\262\003\126\311\114\272\237\215\056\312\277\374\103\304\142"
	"\321\024\112\320\222\061\165\043\321\371\151\014\003\325\322\251"
	"\370\332\127\034\105\361\034\141\235\031\176\375\233\313\326\242"
	"\330\041\152\176\075\040\267\367\207\040\346\331\067\227\317\271"
	"\013\353\231\112\310\114\057\100\215\116\250\240\256\034\052\112"
	"\166\030\154\362\165\052\326\221\306\354\307\131\241\260\157\165"
	"\221\306\037\006\250\242\154\113\061\261\354\367\361\031\361\215"
	"\032\330\260\021\214\327\333\342\037\247\055\057\365\177\270\101"
	"\042\364\134\047\341\210\246\147\377\036\125\132\257\072\227\327"
	"\375\231\127\167\256\336\376\012\206\205\232\201\041\327\354\050"
	"\247\342\077\343\234\146\156\320\005\132\246\317\031\272\066\143"
	"\142\322\221\303\311\276\302\213\360\072\254\000\341\221\340\355"
	"\056\252\353\306\203\021\172\027\053\253\235\345\360\002\202\107"
	"\275\136\223\365\362\026\072\021\011\045\276\123\330\116\175\041"
	"\371\372\110\177\030\264\140\320\365\065\327\353\177\174\275\351"
	"\375\331\000\116\043\051\210\367\136\343\231\037\277\270\033\235"
	"\050\163\107\150\003\312\243\341\121\355\221\211\101\345\073\235"
	"\053\072\106\363\023\212\326\336\171\332\240\207\252\361\047\317"
	"\333\202\176\155\063\357\220\055\137\124\136\200\201\347\067\125"
	"\141\135\225\130\261\374\050\263\010\377\374\312\015\307\345\375"
	"\303\264\236\114\110\356\206\343\077\370\011\004\017\224\155\120"
	"\276\302\000\065\157\151\031\223\072\255\321\052\300\173\126\062"
	"\006\356\346\357\327\200\227\211\055\043\103\104\005\324\066\367"
	"\055\201\162\365\355\250\366\356\360\354\302\142\377\150\361\200"
	"\252\344\304\124\341\022\064\036\265\056\255\057\370\334\146\001"
	"\120\210\247\027\230\266\063\004\131\337\340\104\074\272\005\324"
	"\112\166\046\177\332\261\041\351\163\113\052\076\141\340\144\350"
	"\264\026\344\150\247\370\241\161\012\165\167\232\221\006\217\235"
	"\342\071\346\131\372\002\005\072\033\144\073\050\251\374\027\123"
	"\120\006\142\144\164\273\101\374\246\217\035\050\261\367\255\020"
	"\037\026\365\321\304\134\311\376\012\047\114\171\262\266\325\022"
	"\044\263\066\013\100\122\105\307\350\157\115\267\340\327\031\056"
	"\163\374\232\020\260\362\324\260\137\204\016\254\203\300\277\157"
	"\265\012\113\346\147\305\246\047\165\010\044\162\213\306\205\066"
	"\013\124\365\212\261\173\371\205\306\341\151\004\341\203\017\164"
	"\102\141\357\326\040\340\171\044\203\126\033\315\003\362\113\222"
	"\032\357\112\362\104\037\033\245\266\003\224\055\061\136\202\123"
	"\370\266\074\322\201\124\306\261\203\113\044\243\203\346\064\263"
	"\227\232\113\023\274\340\373\314\000\071\150\125\135\277\043\342"
	"\006\150\245\327\364\344\371\372\204\337\105\354\362\201\146\105"
	"\024\006\157\336\362\152\002\144\357\245\364\155\356\032\144\123"
	"\173\211\024\007\277\073\265\237\357\356\220\005\332\324\171\113"
	"\201\146\063\222\125\321\153\367\126\223\023\335\064\161\135\156"
	"\263\141\317\255\174\314\223\317\031\007\076\054\100\273\174\035"
	"\154\037\250\366\066\370\033\065\043\334\203\007\052\232\251\356"
	"\344\206\222\323\145\253\101\117\122\200\376\226\077\150\144\016"
	"\324\206\040\242\003\145\003\372\334\031\201\143\141\243\317\172"
	"\026\122\144\103\045\210\007\156\100\202\001\271\137\324\013\176"
	"\334\242\347\323\156\145\200\124\005\015\134\063\034\010\235\032"
	"\136\104\272\375\177\154\016\063\253\123\342\224\375\351\307\135"
	"\214\031\372\266\072\116\220\020\031\322\161\125\262\246\221\342"
	"\373\213\323\362\365\273\335\015\227\010\070\212\105\362\130\263"
	"\165\107\233\166\351\033\266\210\257\315\216\157\355\051\277\202"
	"\164\263\223\243\236\060\063\273\072\231\141\301\011\150\212\335"
	"\175\072\232\202\375\266\045\153\324\256\256\010\024\014\244\276"
	"\207\255\351\310\347\066\227\073\167\140\062\370\065\322\340\063"
	"\016\376\322\030\355\242\252\044\241\326\000\237\355\072\371\233"
	"\242\051\271\126\045\136\071\176\251\022\060\200\327\305\070\170"
	"\162\177\126\273\243\256\073\341\362\367\104\267\375\370\162\202"
	"\201\145\177\035\020\220\255\022\276\164\272\316\215\004\112\027"
	"\172\032\141\071\366\277\006\245\144\122\162\257\076\154\112\214"
	"\337\151\121\266\277\031\373\171\371\274\044\232\303\372\313\105"
	"\164\100\131\031\064\041\332\005\002\336\014\042\205\145\246\252"
	"\004\016\354\321\330\243\224\042\330\235\032\254\317\000\141\150"
	"\250\126\260\113\061\116\321\165\136\204\062\344\071\037\177\164"
	"\364\203\337\301\271\241\322\025\350\112\102\361\021\253\227\113"
	"\215\157\334\141\346\041\270\002\046\243\204\122\174\122\021\262"
	"\130\015\042\116\217\217\164\344\166\355\265\354\166\021\071\357"
	"\223\275\002\303\232\312\355\016\254\303\304\142\313\316\106\024"
	"\271\245\371\162\003\242\001\124\136\317\323\274\071\212\034\302"
	"\160\201\105\147\201\071\272\321\226\355\300\173\116\303\373\177"
	"\211\206\044\153\252\160\004\064\104\317\047\250\167\315\277\306"
	"\324\131\331\276\024\116\270\325\061\017\275\316\316\220\366\274"
	"\107\313\252\120\244\056\276\270\046\070\072\033\167\022\142\314"
	"\020\255\067\251\315\265\333\340\240\146\142\232\304\042\336\171"
	"\062\162\126\145\036\134\362\240\222\327\234\303\344\040\204\024"
	"\074\350\261\246\136\377\156\226\161\247\150\061\311\046\076\271"
	"\135\125\153\327\002\330\065\246\260\033\010\135\117\304\143\107"
	"\124\062\265\157\132\103\033\374\230\032\265\117\041\263\221\142"
	"\226\257\332\347\334\327\352\016\304\022\004\154\202\123\042\177"
	"\040\000\123\062\335\037\001\171\220\152\231\332\116\364\317\165"
	"\372\361\010\217\001\254\271\323\177\037\210\275\355\152\151\271"
	"\325\102\141\021\064\225\155\272\066\124\174\041\234\233\035\333"
	"\243\141\052\120\270\025\373\136\372\230\166\011\324\227\355\056"
	"\011\141\240\133\112\267\226\123\340\250\156\134\150\140\327\124"
	"\150\144\356\110\062\154\311\076\176\171\332\277\012\131\037\264"
	"\222\012\235\312\265\034\266\177\334\103\301\161\366\177\004\353"
	"\032\310\021\050\233\247\077\007\043\037\136\174\033\355\243\250"
	"\131\017\126\214\307\007\256\031\337\256\362\220\252\075\154\267"
	"\022\110\067\034\217\161\001\256\310\055\342\254\035\133\114\353"
	"\230\044\251\035\066\104\172\151\040\306\334\013\155\137\173\024"
	"\236\077\005\117\333\254\266\127\200\063\304\055\262\104\117\031"
	"\265\366\014\302\166\021\223\201\251\244\135\076\076\065\106\150"
	"\045\212\045\016\350\045\005\041\333\161\250\275\317\042\373\110"
	"\373\263\062\142\340\063\007\055\362\116\100\332\171\364\350\162"
	"\267\165\110\335\045\355\116\356\002\022\062\256\254\205\143\257"
	"\231\325\006\375\072\124\202\341\206\242\177\303\320\057\372\011"
	"\150\136\353\032\163\207\201\077\351\061\117\154\203\134\252\353"
	"\171\337\337\313\127\206\222\031\371\222\370\333\227\036\247\277"
	"\103\201\002\343\134\164\322\120\036\133\147\217\142\366\023\301"
	"\154\340\006\051\031\104\026\176\227\134\025\241\131\203\216\062"
	"\220\033\037\303\232\024\113\107\261\247\113\246\213\343\267\227"
	"\157\031\203\340\074\072\200\061\022\050\341\263\373\071\053\147"
	"\324\334\377\361\261\203\214\064\143\307\275\333\042\146\260\347"
	"\253\277\072\174\005\320\132\077\062\016\216\224\231\003\067\021"
	"\365\176\230\306\237\323\075\114\037\062\300\345\026\205\110\236"
	"\345\054\155\312\213\051\272\202\115\301\056\201\230\102\002\332"
	"\011\255\050\336\372\220\340\356\127\326\006\067\120\222\145\117"
	"\277\226\201\244\122\246\014\142\040\204\263\064\056\226\157\354"
	"\077\153\347\113\051\235\363\023\065\114\150\346\265\375\320\335"
	"\121\314\265\126\144\054\316\215\114\025\260\100\060\147\160\275"
	"\007\377\226\020\157\133\132\243\011\320\062\134\023\115\252\153"
	"\066\365\241\113\370\334\265\361\375\203\016\272\363\035\223\074"
	"\362\261\041\064\220\032\367\051\103\043\046\031\277\002\360\102"
	"\077\341\361\007\013\262\230\267\372\117\221\321\352\106\355\213"
	"\371\001\223\073\005\033\317\124\373\136\034\207\165\262\056\215"
	"\101\033\045\013\276\131\073\042\000\305\025\175\053\356\165\255"
	"\234\130\023\127\072\105\365\255\022\073\251\277\205\373\326\201"
	"\061\235\234\067\235\155\303\156\364\230\140\105\246\032\124\205"
	"\274\012\374\040\006\342\020\074\365\150\027\070\013\271\326\226"
	"\334\143\211\174\004\017\061\073\076\311\065\250\353\327\364\103"
	"\203\206\126\112\231\207\166\322\343\335\316\244\053\063\051\357"
	"\357\137\201\252\131\027\137\321\056\072\151\311\166\061\335\270"
	"\310\040\337\263\046\041\103\112\016\320\255\105\315\062\077\126"
	"\341\205\136\243\015\273\206\177\314\142\265\226\002\204\040\173"
	"\105\130\276\072\124\026\005\055\147\271\161\126\366\135\012\322"
	"\174\331\243\311\172\055\217\070\205\147\367\042\202\345\071\112"
	"\003\070\130\002\003\017\362\213\245\240\216\173\055\271\002\175"
	"\070\201\163\217\222\361\125\317\040\263\273\021\315\065\174\213"
	"\077\307\361\027\173\200\065\054\323\204\356\201\062\377\056\115"
	"\160\033\000\023\114\147\214\265\227\163\271\223\047\331\254\116"
	"\024\307\250\100\315\262\336\250\226\245\355\240\313\157\334\121"
	"\267\075\213\155\235\346\013\016\342\140\156\040\200\054\334\355"
	"\007\351\372\335\310\145\371\024\241\114\176\121\323\207\275\212"
	"\250\237\121\011\023\366\070\143\300\167\301\050\201\235\000\016"
	"\140\234\322\266\234\251\145\262\377\212\031\300\176\131\256\340"
	"\005\075\144\132\047\372\272\347\121\206\201\325\073\371\220\324"
	"\354\022\233\236\035\073\330\277\163\113\174\301\014\242\206\240"
	"\374\024\020\341\345\161\132\157\155\267\206\140\375\246\327\047"
	"\352\352\133\120\177\021\163\363\211\143\034\056\253\234\347\037"
	"\357\100\150\361\017\026\100\261\317\122\235\265\353\300\114\132"
	"\161\033\367\067\217\350\235\304\335\334\246\026\176\242\362\217"
	"\274\116\266\114\155\047\141\255\026\230\361\204\336\357\304\335"
	"\216\141\320\131\002\134\151\033\074\220\134\323\367\127\235\334"
	"\151\343\045\222\044\034\163\005\360\025\163\242\123\176\367\164"
	"\214\034\015\055\225\247\312\161\322\163\315\145\103\051\032\240"
	"\032\066\003\052\374\252\226\237\201\270\373\307\151\222\117\155"
	"\145\172\241\126\133\326\066\062\076\362\321\012\047\053\015\147"
	"\364\223\305\306\017\164\127\260\140\300\015\131\236\310\341\031"
	"\346\125\071\036\216\244\372\314\227\313\327\276\367\345\046\354"
	"\170\353\262\210\140\012\070\301\313\106\032\151\016\373\203\364"
	"\121\274\022\337\141\014\254\371\330\203\270\320\150\336\274\341"
	"\311\157\152\052\171\242\353\104\350\006\256\366\002\062\353\123"
	"\357\375\062\120\012\337\111\343\142\002\263\313\340\160\255\252"
	"\337\027\324\131\271\277\236\242\306\115\231\310\177\204\033\156"
	"\202\116\277\214\055\011\160\220\013\043\134\353\224\011\225\164"
	"\040\151\315\332\051\153\175\357\271\026\270\070\233\324\246\035"
	"\042\145\252\120\157\032\341\172\076\075\145\323\107\373\107\147"
	"\145\024\102\216\200\277\176\071\326\067\162\161\013\031\217\055"
	"\177\072\176\356\125\137\150\223\235\316\147\344\311\256\114\056"
	"\303\216\275"
#define      tst2_z	19
#define      tst2	((&data[3549]))
	"\175\013\135\230\044\240\172\350\201\163\177\224\154\240\200\302"
	"\021\141\037\141\044"
#define      chk2_z	19
#define      chk2	((&data[3573]))
	"\176\011\045\254\126\242\266\061\334\373\122\032\060\350\227\260"
	"\143\364\061\136\341\344\240\210\137"
#define      pswd_z	256
#define      pswd	((&data[3624]))
	"\212\337\110\050\255\257\014\167\136\131\245\041\347\143\145\066"
	"\240\343\132\023\323\360\222\334\026\077\145\165\152\334\017\031"
	"\016\331\012\176\001\252\300\054\037\365\271\370\270\170\332\336"
	"\220\376\003\160\020\172\364\000\316\345\333\275\236\353\327\255"
	"\304\341\053\306\214\354\362\253\341\254\244\231\044\177\170\265"
	"\175\173\045\215\366\031\216\305\377\151\202\235\124\132\113\031"
	"\073\166\340\310\143\323\163\104\177\030\336\244\227\126\131\024"
	"\322\177\242\310\231\060\216\230\231\021\066\356\153\201\010\247"
	"\370\350\157\133\273\343\237\073\373\175\337\223\324\070\247\246"
	"\267\111\157\120\172\375\350\024\016\036\002\172\240\013\041\230"
	"\364\220\363\260\164\223\353\160\021\312\003\345\003\252\213\272"
	"\364\373\013\157\370\364\203\007\023\206\201\263\221\242\113\205"
	"\063\077\065\250\322\041\030\343\353\033\311\356\306\125\251\273"
	"\120\264\052\111\250\255\121\274\063\322\157\305\165\273\112\251"
	"\372\200\121\315\241\151\260\214\205\172\173\113\317\045\006\040"
	"\332\061\151\202\336\273\077\022\215\256\327\003\151\042\254\144"
	"\242\376\061\103\150\342\320\355\134\114\070\054\161\077\114\113"
	"\160\266\316\117\161\015\141\377\273\070\003\045\132\257\052\365"
	"\273\162\035\150\042\052\337\200\203\205\241\152\351\007\241\211"
	"\352\373\234\276\354\057\233\002\156\000\170\330\334\243\315\230"
	"\025\353\000\070\025\340\270\230\145\132\003"
#define      msg1_z	42
#define      msg1	((&data[3929]))
	"\330\114\240\164\300\337\352\234\100\125\240\225\247\245\056\317"
	"\257\173\014\355\140\134\144\332\353\301\070\304\333\101\254\105"
	"\057\315\311\075\177\224\006\374\154\345\330\320\023\032\013\215"
	"\243\246\220\022\247"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	0	/* Define as 1 to enable ptrace the executable */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask  = (unsigned long)&chkenv;
	mask ^= (unsigned long)getpid() * ~mask;
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

#if !defined(TRACEABLE)

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !defined(TRACEABLE) */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];

	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	ret = chkenv(argc);
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
	varg[j++] = argv[0];		/* My own name at execution */
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if !defined(TRACEABLE)
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
