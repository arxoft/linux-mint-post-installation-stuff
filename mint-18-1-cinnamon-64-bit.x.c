#if 0
	shc Version 3.8.9b, Generic Script Compiler
	Copyright (c) 1994-2015 Francisco Rosales <frosal@fi.upm.es>

	shc -f mint-18-1-cinnamon-64-bit 
#endif

static  char data [] = 
#define      rlax_z	1
#define      rlax	((&data[0]))
	"\326"
#define      opts_z	1
#define      opts	((&data[1]))
	"\277"
#define      shll_z	10
#define      shll	((&data[3]))
	"\246\347\253\217\002\240\241\131\077\357\033\005\377"
#define      date_z	1
#define      date	((&data[15]))
	"\356"
#define      pswd_z	256
#define      pswd	((&data[70]))
	"\313\203\117\153\211\164\256\254\053\207\064\242\122\353\217\116"
	"\244\346\267\330\132\242\177\137\242\246\130\251\254\057\337\167"
	"\262\056\342\074\243\220\351\316\030\036\161\152\011\000\271\255"
	"\347\160\206\102\023\006\377\013\377\372\117\240\316\254\105\200"
	"\055\350\262\146\127\173\034\106\206\274\207\263\330\023\015\231"
	"\052\060\006\077\126\005\113\125\000\232\366\316\107\073\117\165"
	"\044\002\333\174\175\370\302\004\265\112\267\215\135\305\047\207"
	"\365\055\307\113\063\022\241\063\255\227\002\364\322\122\151\367"
	"\124\105\163\322\076\066\327\363\200\217\201\335\124\250\144\111"
	"\325\053\224\011\076\066\074\353\315\077\340\240\221\112\227\346"
	"\217\012\271\316\100\220\301\300\037\102\236\163\353\002\275\301"
	"\056\121\312\154\207\007\127\125\106\070\365\330\202\215\277\022"
	"\230\170\340\331\010\242\231\050\345\070\234\320\072\131\222\150"
	"\253\134\324\063\143\054\210\252\145\176\203\347\014\102\371\244"
	"\273\332\175\304\174\027\354\141\117\210\062\212\342\304\362\215"
	"\041\307\300\205\364\111\057\131\310\263\101\324\366\073\171\261"
	"\025\366\165\221\016\142\363\135\352\046\347\315\352\332\132\014"
	"\242\033\221\226\145\301\360\055\164\061\002\152\154\173\034\202"
	"\162\221\024\200\363\007\336\336\056\305\253\031\240\006\045\102"
	"\042\266\331\210\167\312\242\265\254\372\137\130\052\077\320\335"
	"\156\262\032"
#define      msg1_z	42
#define      msg1	((&data[341]))
	"\340\134\350\153\073\051\116\347\102\132\053\113\356\121\015\250"
	"\047\154\015\241\013\233\032\330\344\343\275\043\371\153\160\044"
	"\336\170\114\331\175\141\327\001\170\047\301\174"
#define      inlo_z	3
#define      inlo	((&data[383]))
	"\025\320\201"
#define      xecc_z	15
#define      xecc	((&data[387]))
	"\332\046\157\371\035\325\307\077\105\033\366\124\274\075\315\155"
	"\072\360"
#define      lsto_z	1
#define      lsto	((&data[404]))
	"\010"
#define      tst1_z	22
#define      tst1	((&data[405]))
	"\357\231\075\017\362\154\246\227\011\177\350\210\110\046\342\111"
	"\113\111\031\160\303\013\023\031\031\154"
#define      chk1_z	22
#define      chk1	((&data[433]))
	"\041\306\275\246\275\371\261\136\115\331\201\152\274\067\024\322"
	"\205\140\057\156\215\036\054\275\357"
#define      msg2_z	19
#define      msg2	((&data[460]))
	"\100\270\220\143\207\240\075\242\054\175\320\263\136\003\050\024"
	"\212\226\070\273\306\064\037\012"
#define      text_z	2913
#define      text	((&data[888]))
	"\330\151\227\311\312\024\315\061\063\206\104\115\237\261\221\370"
	"\355\263\276\335\357\227\021\057\117\241\222\131\371\042\266\321"
	"\214\116\232\126\142\150\207\225\356\314\342\216\175\164\206\153"
	"\047\105\111\026\334\132\106\054\373\331\206\364\374\075\306\210"
	"\213\141\336\355\311\146\203\267\063\145\106\261\331\315\034\001"
	"\023\145\027\357\300\136\034\273\067\242\260\063\337\166\274\153"
	"\327\232\130\240\001\333\130\064\101\237\345\033\154\002\034\177"
	"\150\064\157\050\222\214\343\312\056\224\376\016\012\272\171\342"
	"\125\322\203\126\256\333\213\360\172\161\013\347\164\050\146\334"
	"\134\326\005\356\142\351\270\221\175\267\240\210\161\032\152\306"
	"\354\355\035\233\311\251\213\104\032\226\053\217\276\222\153\032"
	"\150\160\011\312\131\302\134\327\171\374\137\352\026\312\261\003"
	"\270\316\236\201\170\051\306\222\277\361\042\176\203\215\231\354"
	"\376\242\267\130\145\023\057\336\017\217\311\045\131\172\050\022"
	"\111\306\224\301\360\132\124\257\114\166\056\317\004\307\274\003"
	"\152\163\134\317\206\214\255\225\033\167\273\165\362\344\207\073"
	"\253\033\375\233\165\122\113\301\311\171\221\316\101\115\321\253"
	"\300\056\172\107\272\050\335\325\237\231\112\221\175\321\315\051"
	"\355\313\304\142\035\020\044\347\212\266\265\313\003\207\167\304"
	"\266\362\013\160\032\351\105\272\202\220\114\000\142\031\051\117"
	"\345\356\262\003\376\326\352\211\214\240\125\220\050\314\124\336"
	"\276\140\117\331\112\224\224\314\045\340\314\207\372\365\326\337"
	"\344\211\343\343\137\316\154\354\156\302\174\227\216\321\166\115"
	"\062\305\047\174\132\273\110\200\233\025\007\225\013\336\165\357"
	"\147\130\322\307\046\077\263\225\001\057\055\217\000\243\335\062"
	"\151\004\257\304\277\367\104\133\335\326\016\015\101\254\340\207"
	"\347\101\301\133\125\346\016\244\150\022\056\322\204\042\172\375"
	"\235\345\141\271\327\153\225\205\062\300\017\310\305\312\166\161"
	"\332\016\006\223\066\354\313\340\151\077\311\315\345\113\337\347"
	"\023\340\130\307\115\322\072\002\250\310\355\025\374\040\070\265"
	"\116\322\106\353\142\130\115\334\167\216\034\332\151\037\314\220"
	"\245\000\136\306\317\325\357\037\276\133\020\055\334\137\156\155"
	"\313\075\340\350\373\372\171\132\336\270\345\035\070\001\176\071"
	"\207\167\030\312\377\207\347\243\156\261\336\333\205\107\346\073"
	"\117\322\132\157\353\215\102\237\165\042\143\222\362\364\305\250"
	"\264\044\310\356\347\123\376\163\031\377\205\357\363\334\007\050"
	"\334\153\313\030\021\235\301\200\012\054\336\260\325\174\036\036"
	"\243\267\231\121\022\343\331\214\250\266\326\163\070\013\015\364"
	"\324\330\303\146\266\275\232\152\070\106\237\013\115\357\034\326"
	"\342\211\275\066\036\134\244\213\031\366\044\224\164\240\070\071"
	"\000\002\375\021\310\043\120\105\060\037\375\220\355\150\145\302"
	"\335\223\310\222\203\012\077\364\327\227\234\356\312\214\005\047"
	"\162\037\254\011\241\335\136\344\250\274\366\117\043\112\246\347"
	"\113\076\073\116\104\035\232\002\010\022\137\212\132\254\264\224"
	"\274\315\100\061\203\370\055\177\166\012\010\125\135\211\157\051"
	"\071\051\036\004\161\223\246\376\121\032\305\276\055\276\225\040"
	"\237\246\352\176\165\145\024\120\132\276\176\364\330\261\261\153"
	"\372\076\133\111\220\157\170\224\174\152\235\006\316\354\315\261"
	"\075\046\053\212\032\140\240\046\111\222\163\332\013\237\356\342"
	"\012\270\231\362\157\230\354\034\314\337\223\063\033\354\372\152"
	"\045\313\007\334\020\160\216\261\323\150\130\066\022\120\262\254"
	"\331\314\046\363\240\350\063\243\075\034\041\050\352\077\327\074"
	"\265\143\047\374\107\304\075\346\254\160\247\375\110\210\162\277"
	"\207\347\276\320\175\347\161\260\322\307\201\145\030\104\217\335"
	"\334\277\107\277\046\362\022\353\052\230\342\325\002\176\274\055"
	"\035\375\224\273\007\160\111\047\106\036\247\256\233\056\341\372"
	"\063\007\062\243\121\040\216\334\227\014\207\054\103\331\113\176"
	"\165\172\327\230\226\171\253\063\120\114\373\352\340\037\220\206"
	"\146\060\031\244\065\274\360\215\307\176\321\221\265\240\122\103"
	"\217\134\147\056\227\067\221\153\064\154\357\335\372\103\164\274"
	"\272\234\107\343\213\375\012\117\053\007\217\134\015\047\023\055"
	"\233\005\357\277\105\350\037\323\015\331\077\313\300\273\104\304"
	"\330\260\352\166\356\057\270\344\350\235\046\213\236\216\267\037"
	"\276\044\264\132\354\065\137\306\217\106\217\346\077\247\005\331"
	"\151\132\067\043\205\340\143\304\223\336\235\221\367\123\202\047"
	"\142\023\256\276\064\345\367\165\206\054\367\251\175\240\144\121"
	"\112\046\226\041\146\173\052\220\133\256\254\323\057\247\104\175"
	"\147\367\156\344\312\071\014\021\370\065\107\003\224\043\330\337"
	"\226\157\034\224\077\011\077\356\112\075\165\175\313\257\303\061"
	"\332\112\031\262\003\201\100\306\122\265\001\361\274\353\374\175"
	"\075\253\103\064\202\164\275\223\363\224\170\122\006\151\060\346"
	"\353\010\102\063\127\356\241\123\056\237\344\152\257\157\314\232"
	"\256\131\105\077\300\350\351\213\032\255\012\322\232\365\203\212"
	"\014\102\262\112\302\101\076\202\020\144\015\370\270\113\146\242"
	"\102\312\142\230\063\353\073\273\274\005\033\032\254\343\310\135"
	"\117\305\214\105\077\160\142\150\261\110\352\244\117\025\043\130"
	"\133\162\245\323\356\367\017\015\234\176\171\100\301\336\145\132"
	"\170\154\354\254\053\131\211\340\044\310\124\354\072\342\332\321"
	"\311\065\350\271\011\315\330\037\166\230\067\335\333\304\122\313"
	"\254\133\052\157\254\070\347\073\336\111\361\172\237\346\260\351"
	"\204\065\004\216\066\167\362\176\275\362\235\144\373\045\313\133"
	"\100\132\105\271\006\035\056\142\050\021\333\140\236\040\242\101"
	"\012\353\355\155\212\261\322\133\064\071\150\346\305\215\372\057"
	"\257\332\174\054\212\045\001\211\246\304\024\050\122\140\135\365"
	"\113\060\001\256\275\312\366\163\064\251\376\145\354\342\223\257"
	"\323\114\117\267\216\131\020\111\313\316\157\151\077\022\242\371"
	"\326\022\347\317\225\346\113\137\111\356\204\345\047\375\254\254"
	"\166\010\007\353\204\226\055\324\067\310\314\255\117\150\073\105"
	"\041\122\166\076\214\162\105\022\373\261\116\360\344\173\323\065"
	"\316\203\032\331\276\040\277\273\053\124\134\276\063\064\017\212"
	"\347\075\350\072\023\124\315\347\316\051\171\115\235\210\157\275"
	"\136\212\262\252\177\165\122\310\146\142\222\011\335\143\167\354"
	"\262\210\041\167\010\171\102\164\273\010\047\363\332\374\015\235"
	"\301\113\234\230\031\222\211\126\010\014\032\003\346\310\141\176"
	"\211\001\300\211\146\313\353\000\033\375\360\360\216\073\056\200"
	"\006\220\016\327\141\243\305\235\322\376\062\300\134\343\107\126"
	"\161\252\366\342\233\213\371\265\075\237\260\300\115\140\254\112"
	"\375\146\014\122\170\302\031\104\207\333\154\176\375\077\046\162"
	"\123\011\122\124\272\124\204\043\227\215\233\132\267\321\314\147"
	"\360\112\044\025\135\166\110\164\065\135\311\351\111\112\145\135"
	"\352\100\203\050\010\124\341\103\306\360\243\143\043\036\347\125"
	"\363\267\372\073\345\341\147\305\066\053\263\173\051\240\146\371"
	"\072\176\110\017\122\200\105\375\274\200\120\143\025\376\226\054"
	"\041\007\244\243\235\126\243\332\177\370\361\242\164\166\137\136"
	"\063\340\022\135\237\101\146\137\037\313\364\151\042\310\012\004"
	"\321\225\215\311\024\237\136\255\365\234\146\253\276\215\236\077"
	"\331\056\367\155\371\130\266\002\033\110\300\277\103\331\040\246"
	"\251\103\125\200\024\022\232\250\375\305\253\235\310\120\105\062"
	"\074\101\120\206\375\111\303\220\173\171\233\172\016\204\332\040"
	"\313\036\125\373\365\016\041\170\317\207\264\270\005\105\141\316"
	"\242\177\023\374\215\201\243\147\333\174\176\004\366\232\263\233"
	"\072\100\205\237\051\331\030\060\271\331\115\123\122\052\063\105"
	"\210\120\124\050\144\101\362\032\350\376\212\042\122\074\162\351"
	"\207\053\037\207\252\222\230\007\132\204\076\006\120\002\007\325"
	"\156\037\260\036\226\120\312\273\003\155\004\042\127\151\010\356"
	"\226\217\232\315\075\051\175\017\055\226\135\000\273\073\143\106"
	"\015\004\071\376\134\167\025\375\122\274\175\151\240\003\212\310"
	"\115\170\325\140\363\045\302\323\371\031\317\260\032\325\127\006"
	"\142\240\365\234\346\205\305\370\253\101\322\302\351\213\025\266"
	"\074\334\126\157\275\201\124\053\023\066\265\316\127\133\234\142"
	"\232\375\376\172\024\007\353\216\311\117\034\323\147\204\124\147"
	"\166\243\373\145\377\007\354\302\330\253\365\352\023\126\112\276"
	"\067\026\061\127\264\323\336\063\254\317\045\365\123\161\307\076"
	"\012\042\006\361\157\321\211\137\073\130\313\360\321\367\161\174"
	"\373\315\161\047\323\152\224\262\050\133\212\051\055\363\135\126"
	"\225\237\361\066\132\234\271\012\052\257\211\312\150\174\123\126"
	"\316\014\317\061\076\316\065\075\336\034\203\322\331\100\075\206"
	"\374\110\265\021\376\235\210\113\044\006\077\144\342\167\125\057"
	"\106\340\253\011\352\073\320\264\112\301\234\130\246\240\055\006"
	"\006\321\373\301\306\161\136\210\014\051\306\323\152\303\242\042"
	"\166\274\214\275\151\145\145\240\155\050\325\100\037\144\076\322"
	"\142\144\264\073\004\117\337\221\073\031\027\130\154\273\145\311"
	"\001\377\076\076\317\237\015\363\112\317\231\345\122\074\077\302"
	"\072\273\005\152\115\045\202\250\265\325\176\353\212\337\203\270"
	"\016\220\324\066\316\215\125\051\317\100\200\223\163\233\222\157"
	"\101\153\173\202\042\102\015\355\100\224\305\215\207\165\210\151"
	"\213\324\271\201\237\221\002\223\325\113\364\336\125\117\152\313"
	"\215\340\310\053\074\007\060\345\300\177\345\101\306\063\377\165"
	"\200\164\147\365\367\076\314\051\311\254\273\140\070\205\355\304"
	"\275\041\203\341\141\030\005\242\116\260\315\132\353\227\346\100"
	"\345\277\123\213\116\342\267\045\224\343\032\341\077\353\176\174"
	"\327\270\257\317\337\076\155\146\240\101\333\270\350\322\212\337"
	"\365\360\130\026\066\320\265\366\266\265\070\256\056\241\307\341"
	"\072\306\005\205\223\350\004\215\326\056\266\030\062\320\045\354"
	"\163\254\105\056\332\337\122\272\232\174\326\003\162\247\007\175"
	"\212\221\071\063\240\307\216\152\161\330\030\353\274\042\156\050"
	"\002\105\300\330\340\143\264\105\221\344\335\357\115\107\133\115"
	"\357\000\004\271\255\207\001\124\256\007\231\073\117\070\113\350"
	"\200\061\345\362\053\330\144\321\007\333\350\301\031\104\252\220"
	"\343\210\145\066\043\140\033\274\013\140\365\271\307\335\241\126"
	"\075\023\071\100\147\325\347\365\376\366\354\034\346\261\335\330"
	"\056\226\316\173\132\363\166\337\355\362\211\066\226\317\302\076"
	"\001\133\062\055\201\171\101\212\227\147\130\244\207\224\010\244"
	"\040\223\114\075\037\076\051\146\170\270\021\034\142\115\166\224"
	"\076\253\345\350\006\174\107\234\037\351\117\026\255\017\114\045"
	"\212\347\055\013\073\250\250\241\342\246\234\000\220\306\110\314"
	"\036\070\215\117\163\010\072\020\337\322\253\115\062\302\012\325"
	"\035\374\276\166\246\344\025\007\213\005\127\057\155\333\170\062"
	"\342\122\142\046\311\112\230\243\060\316\263\277\007\025\165\347"
	"\134\355\174\364\154\034\176\213\136\160\010\040\045\252\170\157"
	"\163\165\251\351\317\165\145\173\021\164\126\043\377\120\150\254"
	"\244\357\373\045\001\144\227\201\170\100\244\275\275\163\305\117"
	"\362\202\145\363\010\133\316\052\164\205\235\210\044\162\040\063"
	"\122\022\144\276\075\317\163\226\365\043\017\253\065\212\234\160"
	"\111\244\202\064\334\140\106\331\006\342\301\300\117\016\373\165"
	"\066\221\366\205\014\114\017\327\051\270\374\316\072\070\065\036"
	"\276\061\215\151\122\121\106\014\036\036\127\354\062\360\057\365"
	"\352\314\100\174\231\255\373\106\016\361\002\367\206\014\114\025"
	"\332\363\377\220\010\030\377\056\364\343\017\004\322\054\054\310"
	"\370\123\264\350\323\230\150\017\157\366\065\315\302\070\223\270"
	"\011\311\130\216\373\253\103\046\135\336\154\254\233\343\317\206"
	"\123\324\260\232\214\356\046\164\241\145\357\035\333\001\343\104"
	"\161\257\013\371\210\071\063\251\106\266\047\053\117\204\130\253"
	"\126\276\023\115\170\206\101\365\007\270\353\236\343\164\227\116"
	"\107\100\344\232\263\157\355\156\312\067\076\210\313\364\215\135"
	"\173\232\001\100\174\011\320\174\220\023\356\201\377\106\042\032"
	"\257\300\115\206\100\272\033\215\204\000\003\326\134\216\304\042"
	"\206\023\040\217\375\005\266\017\071\205\036\343\021\261\371\074"
	"\013\111\041\231\360\321\043\230\135\031\171\267\366\375\364\334"
	"\354\147\145\322\026\064\342\052\054\116\141\114\034\222\025\164"
	"\251\030\376\126\216\251\230\103\135\363\205\142\117\376\060\061"
	"\010\247\176\113\150\235\276\270\226\275\156\037\113\372\154\205"
	"\043\336\162\106\276\157\247\024\371\221\277\332\327\377\107\346"
	"\353\124\064\153\064\130\327\044\267\006\125\106\332\141\347\027"
	"\354\001\323\355\337\245\122\264\253\055\024\250\067\260\123\011"
	"\147\113\142\271\320\107\171\010\342\223\210\230\312\307\200\355"
	"\011\166\354\132\206\043\061\237\100\211\241\346\115\336\237\203"
	"\250\210\123\335\375\061\342\366\244\120\324\146\357\347\243\266"
	"\241\244\027\145\255\270\130\205\061\004\110\270\017\027\377\076"
	"\167\140\243\260\240\064\013\006\067\104\307\025\271\027\006\036"
	"\365\264\352\146\131\044\207\166\335\214\030\120\054\330\056\264"
	"\004\035\255\273\255\237\211\331\144\121\136\201\300\111\337\204"
	"\065\176\076\150\330\176\125\176\067\247\317\062\070\113\206\015"
	"\214\261\375\104\114\332\355\321\003\362\361\133\062\273\123\124"
	"\347\374\322\320\037\217\037\045\141\067\107\230\012\312\031\246"
	"\047\120\332\330\122\144\347\125\124\045\060\321\055\333\177\263"
	"\237\004\174\234\310\132\250\306\210\314\202\203\122\275\323\235"
	"\063\103\262\224\063\254\061\237\310\133\306\331\060\041\051\321"
	"\237\054\367\052\067\305\356\153\361\002\107\222\347\140\341\342"
	"\020\154\127\145\263\062\210\173\066\077\233\221\200\361\367\136"
	"\231\117\266\213\170\376\176\113\141\347\212\023\010\064\355\325"
	"\316\314\315\032\077\326\323\240\120\304\005\205\136\367\272\210"
	"\360\363\354\335\013\134\334\044\175\334\114\333\176\313\337\224"
	"\225\160\006\043\166\247\255\252\313\117\125\110\105\145\137\140"
	"\335\201\300\367\024\177\015\052\372\270\000\255\301\151\236\337"
	"\143\121\067\331\052\332\251\375\314\172\030\334\200\070\324\214"
	"\241\224\327\022\113\251\131\254\001\116\341\114\160\054\016\114"
	"\130\165\371\033\102\136\100\106\337\014\113\361\027\052\146\007"
	"\222\276\331\131\345\030\015\172\032\075\247\252\075\113\207\160"
	"\264\214\040\171\114\027\275\247\044\011\230\074\063\376\103\306"
	"\275\035\037\243\065\055\036\120\152\306\372\250\021\201\031\306"
	"\015\071\077\132\120\374\001\165\006\231\261\071\230\364\377\126"
	"\021\037\371\107\114\027\227\266\335\221\136\357\023\167\266\041"
	"\260\365\173\001\362\175\166\370\026\050\062\257\035\062\005\057"
	"\121\377\167\236\026\016\125\364\240\264\343\264\054\231\326\335"
	"\217\121\336\202\316\125\172\345\176\255\224\233\337\232\312\061"
	"\231\101\317\260\120\045\245\361\331\211\246\005\043\174\342\262"
	"\316\301\065\235\027\260\202\225\135\027\060\074\262\373\156\113"
	"\075\075\374\216\142\241\177\074\052\045\101\115\242\044\000\160"
	"\345\065\015\374\345\220\221\103\247\302\200\131\276\356\245\373"
	"\054\242\211\217\103\011\313\156\057\015\274\321\061\275\101\026"
	"\363\117\023\331\337\245\034\206\147\234\340\046\213\206\041\267"
	"\050\253\106\154\265\022\333\344\037\227\265\120\125\367\147\110"
	"\106\172\041\045\037\075\254\207\332\215\255\145\024\317\035\074"
	"\173"
#define      tst2_z	19
#define      tst2	((&data[4068]))
	"\166\204\024\256\335\377\362\234\143\343\165\375\326\136\101\026"
	"\056\306\013\237\274\242"
#define      chk2_z	19
#define      chk2	((&data[4087]))
	"\236\330\252\350\012\270\173\172\150\163\032\034\304\353\110\021"
	"\166\250\236\346\161\301"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	0	/* Define as 1 to enable ptrace the executable */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask  = (unsigned long)&chkenv;
	mask ^= (unsigned long)getpid() * ~mask;
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

#if !defined(TRACEABLE)

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !defined(TRACEABLE) */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];

	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	ret = chkenv(argc);
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
	varg[j++] = argv[0];		/* My own name at execution */
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if !defined(TRACEABLE)
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
